<!doctype html>
<html>
<head>
    <script src="../src/knob.js?123"></script>
    <style>
        body {
            background-color: #eee;
        }
        #main {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
        }

        #main > div {
            /*width: 20vw;*/
            background-color: #fff;
            margin: 10px;
            border: 1px solid #999;
        }

        .knob {
            height: 40vh;   /* 20% of viewport height */
            /*background-color: #ccc;*/
            display: block;
        }
/*
        .knob text {
            font-family: sans-serif;
            font-size: 100%;
            cursor: default;
            z-index: 1;
        }
        text.value, text.label {
            text-anchor: middle;
        }
*/
        .arc {
            /*stroke: black;*/
            /*stroke-width: 5%;*/
            fill: transparent;
            /*stroke-linecap: round;*/
        }
/*
        .back {
            stroke: #aaa;
            stroke-width: 6px;
            fill: transparent;
        }
        .marker {
            stroke: #aaa;
            stroke-width: 1px;
        }
*/
        #knob2 text.value {
            font-family: sans-serif;
            font-size: 200%;
            baseline-shift: -20%;   /* use this property to correct the text vertical position */
            font-weight: bold;
            cursor: default;
            /*z-index: 1;*/
        }
    </style>
</head>
<body>
    <div id="main">
        <div>
            <svg class="knob" id="knob1" data-label="default"></svg>
            <!--<div class="knob-menu" id="knob1-menu"></div>-->
            <input type="text" id="i" size="3"/><button id="b">set value</button>
            <div>
                knob 1 value: <span id="v-knob1"></span>
            </div>
        </div>
        <div>
            <svg class="knob" id="knob2" data-config='{"arc_min": 20, "value_max":127}' data-label="Large font"></svg>
            <div>
                knob 2 value: <span id="v-knob2"></span>
            </div>
        </div>
        <div>
            <svg class="knob" id="knob3" data-config='{"arc_min": 0, "value_max":127}' data-label="Dot cursor"></svg>
        </div>
        <div>
            <svg class="knob" id="knob4" data-config='{"arc_min": 0, "value_max":127}' data-label=""></svg>
        </div>
        <div>
            <svg class="knob" id="knob5" data-config='{"arc_min": 0, "value_max":127}' data-label=""></svg>
        </div>
        <div>
            <svg class="knob" id="knob6" data-config='{"with_label": false, "arc_min": 0, "value_max":127}'></svg>
        </div>
    </div>
</body>
<script type="text/javascript">

    document.addEventListener("DOMContentLoaded", function(event) {
        console.log('DOMContentLoaded');

        var my_knobs = {};

        var knobs = document.querySelectorAll('svg.knob');
        [].forEach.call(knobs, function(element) {
            console.log('new knob for', element.id);
            my_knobs[element.id] = new knob(element, {arcMin:45});

            console.log('addf listener for', element.id);
            element.addEventListener("change", function(event) {
                console.log('change event', event);
                document.getElementById('v-' + element.id).innerHTML = event.detail;
            });
        });

        console.log(my_knobs);

        var i = document.getElementById('i');
        i.addEventListener("change", function(event) {
//            let k = document.getElementById('knob1');
//            console.log(k);
            console.log(event, this, this.value);
            let v = parseFloat(this.value);
            if (!isNaN(v)) {
                my_knobs['knob1'].value = v;
            }
        });

    });

</script>
</html>
